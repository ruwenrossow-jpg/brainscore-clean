var Re=Object.defineProperty;var Ge=(g,e,l)=>e in g?Re(g,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):g[e]=l;var ke=(g,e,l)=>Ge(g,typeof e!="symbol"?e+"":e,l);import{f as E,t as oe,a as h,c as V}from"../chunks/O6Scfog5.js";import{h as Te,s as a,c as r,n as Z,r as s,p as ce,d as w,$ as Ce,b as c,g as t,t as X,aD as se,a as de,f as Q}from"../chunks/_KxZsWR2.js";import{i as F}from"../chunks/C5zH9Bdp.js";import{B as ue}from"../chunks/DUngGjmV.js";import{B as ve}from"../chunks/Da8G-eBB.js";import{a as Ee}from"../chunks/ClDAKjVE.js";import{d as Se,s as j}from"../chunks/DYLJxuZE.js";import{t as Ie}from"../chunks/i09DBs4C.js";import{a as Ae,s as ze}from"../chunks/D6LAuGEZ.js";import{s as Me}from"../chunks/BsE10o59.js";import{c as De}from"../chunks/C5Chkb5p.js";import{r as P,b as K}from"../chunks/BOC29LpK.js";import"../chunks/2dDfPV3f.js";function $e(g,e,l,n){var b=g.__style;if(Te||b!==e){var u=Ie(e);(!Te||u!==g.getAttribute("style"))&&(u==null?g.removeAttribute("style"):g.style.cssText=u),g.__style=e}return n}var Fe=E(`<div class="space-y-6 mt-6"><div class="bg-white p-6 rounded-lg border border-gray-300"><h3 class="font-semibold text-lg mb-4 text-black">So funktioniert's:</h3> <ul class="space-y-3 text-left"><li class="flex items-start"><span class="text-2xl mr-3">ğŸ‘€</span> <span class="text-gray-700">Es erscheinen nacheinander <strong>Zahlen von 1-9</strong></span></li> <li class="flex items-start"><span class="text-2xl mr-3">âœ“</span> <span class="text-gray-700">Klicke den Button bei <strong>allen Zahlen</strong></span></li> <li class="flex items-start"><span class="text-2xl mr-3">âš ï¸</span> <span class="text-gray-700"><strong class="text-black">AUSNAHME:</strong> Bei der <strong class="text-2xl">3</strong> â†’ <strong>NICHT</strong> klicken!</span></li></ul></div> <div class="text-center"><p class="text-sm text-gray-600">â±ï¸ Dauer: <strong>ca. 45 Sekunden</strong></p></div> <!> <p class="text-xs text-gray-500 text-center">ğŸ’¡ Tipp: Finde den richtigen Rhythmus zwischen Geschwindigkeit und Genauigkeit</p></div>`);function We(g,e){ue(g,{title:"Konzentrationstest",subtitle:"Sustained Attention to Response Task",centered:!0,maxWidth:"lg",children:(l,n)=>{var b=Fe(),u=a(r(b),4);ve(u,{variant:"primary",size:"lg",fullWidth:!0,get onclick(){return e.onStart},children:(d,p)=>{Z();var f=oe("Jetzt starten");h(d,f)},$$slots:{default:!0}}),Z(2),s(b),h(l,b)},$$slots:{default:!0}})}class Y{static generateTrials(e=this.DEFAULT_CONFIG){const l=[];for(let n=0;n<e.totalTrials;n++){const b=Math.floor(Math.random()*9)+1;l.push({index:n,digit:b,isNoGo:b===e.noGoDigit,responded:!1,reactionTimeMs:null})}return l}static computeMetrics(e){const l=e.filter(i=>!i.isNoGo),n=e.filter(i=>i.isNoGo),b=n.filter(i=>i.responded).length,u=l.filter(i=>!i.responded).length,d=l.filter(i=>i.responded&&i.reactionTimeMs!==null).map(i=>i.reactionTimeMs),p=d.length?d.reduce((i,z)=>i+z,0)/d.length:0,f=d.length>1?Math.sqrt(d.map(i=>Math.pow(i-p,2)).reduce((i,z)=>i+z,0)/(d.length-1)):0,v=n.length?b/n.length:0,k=l.length?u/l.length:0,m=100*(1-v),N=100*(1-k),A=p?Math.max(0,Math.min(100,(700-p)/4)):50,_=f?Math.max(0,Math.min(100,100-f/3)):50,y=Math.round(.35*m+.25*N+.25*A+.15*_);return{commissionErrors:b,omissionErrors:u,goTrialsCount:l.length,noGoTrialsCount:n.length,meanReactionTimeMs:Math.round(p),sdReactionTimeMs:Math.round(f),score:y}}static async saveSartSession(e,l){try{const{data:n,error:b}=await Me.from("sart_sessions").insert({user_id:l||null,commission_errors:e.commissionErrors,omission_errors:e.omissionErrors,go_count:e.goTrialsCount,nogo_count:e.noGoTrialsCount,mean_rt_ms:e.meanReactionTimeMs,sd_rt_ms:e.sdReactionTimeMs,brain_score:e.score}).select("id").single();if(b)throw b;return(n==null?void 0:n.id)||null}catch(n){return console.error("âŒ Error saving SART session:",n),null}}static async saveScreentimeReport(e,l,n,b,u,d,p,f,v,k){try{const{error:m}=await Me.from("screentime_reports").insert({session_id:e,user_id:b||null,total_minutes:l,activations:n,app1_name:u||null,app1_activations:d||null,app2_name:p||null,app2_activations:f||null,app3_name:v||null,app3_activations:k||null});if(m)throw m;return!0}catch(m){return console.error("âŒ Error saving screentime:",m),!1}}static getScoreLabel(e){return e>=80?"âš¡ Hervorragend":e>=60?"ğŸ‘ Gut":e>=40?"ğŸ“Š Durchschnittlich":"ğŸ“‰ Ãœbung macht den Meister"}}ke(Y,"DEFAULT_CONFIG",{totalTrials:45,trialDurationMs:1e3,noGoDigit:3});var Ue=E('<div class="text-8xl font-bold text-gray-300">âœ±</div>'),Le=E('<div class="font-mono text-8xl font-bold text-black tracking-tighter"> </div>'),Pe=E('<div class="text-center"><div class="loading loading-spinner loading-lg mb-4"></div> <p class="text-gray-600">Test wird ausgewertet...</p></div>'),Ke=E('<div class="card bg-base-200 shadow-lg w-full max-w-lg border border-gray-200"><div class="card-body items-center text-center"><div class="w-full flex justify-between items-center mb-4"><h2 class="text-lg font-semibold text-black">Konzentrationstest</h2> <span class="text-sm text-gray-600 font-mono"> </span></div> <div class="w-full bg-gray-300 rounded-full h-2 mb-8"><div class="bg-black h-2 rounded-full transition-all duration-300"></div></div> <div class="min-h-[300px] flex items-center justify-center my-8 p-8 bg-white rounded-lg border-2 border-gray-300 w-full"><!></div> <div class="w-full mt-4"><button class="btn btn-primary btn-lg w-full h-20 text-white text-xl hover:opacity-90 transition-opacity">Reagieren</button></div> <p class="text-xs text-gray-500 mt-4">âš ï¸ Nicht bei der <strong>3</strong> klicken!</p></div></div>');function Ze(g,e){ce(e,!0);const l=()=>Ae(De,"$currentUser",n),[n,b]=ze(),u={totalTrials:45,trialDurationMs:500,maskDurationMs:900,noGoDigit:3};let d=w(Ce([])),p=w(0),f=w(!1),v=w(!1),k=0,m=null,N=se(()=>t(d)[t(p)]),A=se(()=>{var x;return((x=t(N))==null?void 0:x.digit)||0}),_=se(()=>t(p)/u.totalTrials*100);c(d,Y.generateTrials(u),!0),c(p,0),c(f,!0),y();function y(){if(t(p)>=t(d).length){z();return}c(v,!1),k=performance.now(),m&&clearTimeout(m),m=window.setTimeout(()=>{c(v,!0),m=window.setTimeout(()=>{c(p,t(p)+1),y()},u.maskDurationMs)},u.trialDurationMs)}function i(){if(!t(f)||t(p)>=t(d).length||t(v))return;const x=t(d)[t(p)],B=performance.now()-k;x.responded||(x.responded=!0,x.reactionTimeMs=B)}async function z(){var O;c(f,!1),m&&clearTimeout(m);const x=Y.computeMetrics(t(d)),B=await Y.saveSartSession(x,(O=l())==null?void 0:O.id);e.onComplete({metrics:x,sessionId:B})}Ee(()=>{m&&clearTimeout(m)});var R=Ke(),T=r(R),M=r(T),I=a(r(M),2),$=r(I);s(I),s(M);var D=a(M,2),S=r(D);s(D);var G=a(D,2),H=r(G);{var q=x=>{var B=V(),O=Q(B);{var ae=U=>{var L=Ue();h(U,L)},ie=U=>{var L=Le(),re=r(L,!0);s(L),X(()=>j(re,t(A))),h(U,L)};F(O,U=>{t(v)?U(ae):U(ie,!1)})}h(x,B)},W=x=>{var B=Pe();h(x,B)};F(H,x=>{t(f)?x(q):x(W,!1)})}s(G);var ee=a(G,2),te=r(ee);te.__click=i,s(ee),Z(2),s(T),s(R),X(()=>{j($,`${t(p)??""} / ${u.totalTrials}`),$e(S,`width: ${t(_)??""}%`),te.disabled=!t(f)}),h(g,R),de(),b()}Se(["click"]);var je=E('<div class="space-y-8 mt-6"><div class="bg-white p-8 rounded-lg border-2 border-black"><p class="text-sm text-gray-600 uppercase tracking-wide mb-2">BrainScore</p> <div class="text-7xl font-bold text-black mb-2"> </div> <p class="text-lg text-gray-700"> </p></div> <div class="grid grid-cols-2 gap-4"><div class="bg-white p-4 rounded-lg border border-gray-300 text-center"><div class="text-3xl font-bold text-black"> </div> <p class="text-xs text-gray-600 mt-1">Falsch reagiert<br/>(bei "3" geklickt)</p></div> <div class="bg-white p-4 rounded-lg border border-gray-300 text-center"><div class="text-3xl font-bold text-black"> </div> <p class="text-xs text-gray-600 mt-1">Ausgelassen<br/>(nicht geklickt)</p></div> <div class="bg-white p-4 rounded-lg border border-gray-300 text-center col-span-2"><div class="text-3xl font-bold text-black"> </div> <p class="text-xs text-gray-600 mt-1">Durchschnittliche Reaktionszeit</p></div></div> <!> <p class="text-xs text-gray-500 text-center">ğŸ“Š Deine Daten helfen uns, ZusammenhÃ¤nge zwischen Bildschirmzeit und Konzentration zu verstehen</p></div>');function He(g,e){ce(e,!0);let l=se(()=>e.metrics?Y.getScoreLabel(e.metrics.score):"");var n=V(),b=Q(n);{var u=d=>{ue(d,{title:"Dein Ergebnis",subtitle:"Konzentrationstest abgeschlossen",centered:!0,maxWidth:"lg",children:(p,f)=>{var v=je(),k=r(v),m=a(r(k),2),N=r(m,!0);s(m);var A=a(m,2),_=r(A,!0);s(A),s(k);var y=a(k,2),i=r(y),z=r(i),R=r(z,!0);s(z),Z(2),s(i);var T=a(i,2),M=r(T),I=r(M,!0);s(M),Z(2),s(T);var $=a(T,2),D=r($),S=r(D);s(D),Z(2),s($),s(y);var G=a(y,2);ve(G,{variant:"primary",size:"lg",fullWidth:!0,get onclick(){return e.onNext},children:(H,q)=>{Z();var W=oe("Weiter zu Screentime-Analyse");h(H,W)},$$slots:{default:!0}}),Z(2),s(v),X(()=>{j(N,e.metrics.score),j(_,t(l)),j(R,e.metrics.commissionErrors),j(I,e.metrics.omissionErrors),j(S,`${e.metrics.meanReactionTimeMs??""} ms`)}),h(p,v)},$$slots:{default:!0}})};F(b,d=>{e.metrics&&d(u)})}h(g,n),de()}var Oe=E('<div class="text-center p-2 bg-gray-100 rounded"><p class="text-sm text-gray-600">Gesamt: <strong> </strong></p></div>'),qe=E('<div class="text-center p-3 bg-gray-100 rounded-lg"><p class="text-sm font-medium"> </p></div>'),Je=E('<div class="space-y-6 mt-6"><div class="bg-white p-4 rounded-lg border border-gray-300"><p class="text-sm text-gray-700 text-center">ğŸ“± Trage deine Smartphone-Nutzung der <strong>letzten 24 Stunden</strong> ein.<br/> <span class="text-xs text-gray-500">Zu finden in den Einstellungen unter "Bildschirmzeit" oder "Digitales Wohlbefinden"</span></p></div> <div class="space-y-4"><h3 class="font-semibold text-lg text-black">ğŸ“Š Bildschirmzeit</h3> <div class="grid grid-cols-2 gap-4"><div class="form-control w-full"><label class="label" for="hours"><span class="label-text text-black font-medium">Stunden</span></label> <input id="hours" type="number" min="0" max="24" placeholder="z.B. 3" class="input input-bordered w-full text-lg bg-white border-gray-300 focus:border-black"/></div> <div class="form-control w-full"><label class="label" for="minutes"><span class="label-text text-black font-medium">Minuten</span></label> <input id="minutes" type="number" min="0" max="59" placeholder="z.B. 45" class="input input-bordered w-full text-lg bg-white border-gray-300 focus:border-black"/></div></div> <!> <div class="form-control w-full"><label class="label" for="activations"><span class="label-text text-black font-medium">Aktivierungen</span> <span class="label-text-alt text-gray-500">Wie oft das Handy entsperrt wurde</span></label> <input id="activations" type="number" min="0" placeholder="z.B. 65" class="input input-bordered w-full text-lg bg-white border-gray-300 focus:border-black"/></div></div> <div class="divider my-2"></div> <div class="space-y-4"><h3 class="font-semibold text-lg text-black">ğŸ“± Top 3 Apps (optional)</h3> <p class="text-xs text-gray-500">Die Apps mit den meisten Aktivierungen</p> <div class="grid grid-cols-2 gap-4"><div class="form-control w-full"><label class="label" for="app1"><span class="label-text text-black">1. App-Name</span></label> <input id="app1" type="text" placeholder="z.B. Instagram" class="input input-bordered w-full bg-white border-gray-300 focus:border-black"/></div> <div class="form-control w-full"><label class="label" for="app1Act"><span class="label-text text-black">Aktivierungen</span></label> <input id="app1Act" type="number" min="0" placeholder="z.B. 25" class="input input-bordered w-full bg-white border-gray-300 focus:border-black"/></div></div> <div class="grid grid-cols-2 gap-4"><div class="form-control w-full"><label class="label" for="app2"><span class="label-text text-black">2. App-Name</span></label> <input id="app2" type="text" placeholder="z.B. WhatsApp" class="input input-bordered w-full bg-white border-gray-300 focus:border-black"/></div> <div class="form-control w-full"><label class="label" for="app2Act"><span class="label-text text-black">Aktivierungen</span></label> <input id="app2Act" type="number" min="0" placeholder="z.B. 18" class="input input-bordered w-full bg-white border-gray-300 focus:border-black"/></div></div> <div class="grid grid-cols-2 gap-4"><div class="form-control w-full"><label class="label" for="app3"><span class="label-text text-black">3. App-Name</span></label> <input id="app3" type="text" placeholder="z.B. TikTok" class="input input-bordered w-full bg-white border-gray-300 focus:border-black"/></div> <div class="form-control w-full"><label class="label" for="app3Act"><span class="label-text text-black">Aktivierungen</span></label> <input id="app3Act" type="number" min="0" placeholder="z.B. 12" class="input input-bordered w-full bg-white border-gray-300 focus:border-black"/></div></div></div> <!> <!> <button class="btn btn-ghost btn-sm w-full text-gray-600">Ãœberspringen</button></div>');function Ve(g,e){ce(e,!0);const l=()=>Ae(De,"$currentUser",n),[n,b]=ze();let u=w(0),d=w(0),p=w(0),f=w(""),v=w(0),k=w(""),m=w(0),N=w(""),A=w(0),_=w(!1),y=w(""),i=se(()=>t(u)*60+t(d));async function z(){var T;if(!e.sessionId){c(y,"âŒ Fehler: Keine Session-ID");return}c(_,!0),c(y,"â³ Speichere...");const R=await Y.saveScreentimeReport(e.sessionId,t(i),t(p),(T=l())==null?void 0:T.id,t(f)||void 0,t(v)||void 0,t(k)||void 0,t(m)||void 0,t(N)||void 0,t(A)||void 0);c(_,!1),R?(c(y,"âœ… Gespeichert!"),setTimeout(e.onComplete,800)):c(y,"âŒ Fehler beim Speichern")}ue(g,{title:"Screentime-Analyse",subtitle:"Letzter Schritt (optional)",centered:!0,maxWidth:"lg",children:(R,T)=>{var M=Je(),I=a(r(M),2),$=a(r(I),2),D=r($),S=a(r(D),2);P(S),s(D);var G=a(D,2),H=a(r(G),2);P(H),s(G),s($);var q=a($,2);{var W=o=>{var C=Oe(),J=r(C),le=a(r(J)),Ne=r(le);s(le),s(J),s(C),X(()=>j(Ne,`${t(i)??""} Minuten`)),h(o,C)};F(q,o=>{t(i)>0&&o(W)})}var ee=a(q,2),te=a(r(ee),2);P(te),s(ee),s(I);var x=a(I,4),B=a(r(x),4),O=r(B),ae=a(r(O),2);P(ae),s(O);var ie=a(O,2),U=a(r(ie),2);P(U),s(ie),s(B);var L=a(B,2),re=r(L),pe=a(r(re),2);P(pe),s(re);var me=a(re,2),ge=a(r(me),2);P(ge),s(me),s(L);var be=a(L,2),ne=r(be),fe=a(r(ne),2);P(fe),s(ne);var xe=a(ne,2),he=a(r(xe),2);P(he),s(xe),s(be),s(x);var _e=a(x,2);{var Be=o=>{var C=qe(),J=r(C),le=r(J,!0);s(J),s(C),X(()=>j(le,t(y))),h(o,C)};F(_e,o=>{t(y)&&o(Be)})}var ye=a(_e,2);ve(ye,{variant:"primary",size:"lg",fullWidth:!0,onclick:z,get loading(){return t(_)},get disabled(){return t(_)},children:(o,C)=>{Z();var J=oe("Speichern & AbschlieÃŸen");h(o,J)},$$slots:{default:!0}});var we=a(ye,2);we.__click=function(...o){var C;(C=e.onComplete)==null||C.apply(this,o)},s(M),X(()=>we.disabled=t(_)),K(S,()=>t(u),o=>c(u,o)),K(H,()=>t(d),o=>c(d,o)),K(te,()=>t(p),o=>c(p,o)),K(ae,()=>t(f),o=>c(f,o)),K(U,()=>t(v),o=>c(v,o)),K(pe,()=>t(k),o=>c(k,o)),K(ge,()=>t(m),o=>c(m,o)),K(fe,()=>t(N),o=>c(N,o)),K(he,()=>t(A),o=>c(A,o)),h(R,M)},$$slots:{default:!0}}),de(),b()}Se(["click"]);var Qe=E(`<div class="card bg-base-200 shadow-lg w-full max-w-md border border-gray-200"><div class="card-body items-center text-center space-y-6"><div class="bg-black text-white rounded-full w-20 h-20 flex items-center justify-center text-4xl">âœ“</div> <div><h2 class="text-3xl font-bold text-black mb-2">Geschafft!</h2> <p class="text-gray-600">Vielen Dank fÃ¼r deine Teilnahme</p></div> <div class="bg-white p-4 rounded-lg border border-gray-300 w-full"><p class="text-sm text-gray-700">Deine Daten wurden <strong>anonym gespeichert</strong> und helfen uns, 
        die Auswirkungen von Bildschirmzeit auf kognitive Performance besser zu verstehen.</p></div> <div class="w-full space-y-3"><a href="/dashboard" class="btn btn-primary btn-lg w-full text-white">Zum Dashboard</a> <a href="/test" class="btn btn-ghost w-full text-gray-700">Nochmal testen</a></div></div></div>`);function Xe(g){var e=Qe();h(g,e)}var Ye=E('<div class="min-h-screen bg-white flex items-center justify-center px-4 py-12"><!></div>');function mt(g){let e=w("instructions"),l=w(null),n=w(null);function b(v){c(l,v.metrics,!0),c(n,v.sessionId,!0),c(e,"result")}var u=Ye(),d=r(u);{var p=v=>{We(v,{onStart:()=>c(e,"test")})},f=v=>{var k=V(),m=Q(k);{var N=_=>{Ze(_,{onComplete:b})},A=_=>{var y=V(),i=Q(y);{var z=T=>{He(T,{get metrics(){return t(l)},onNext:()=>c(e,"screentime")})},R=T=>{var M=V(),I=Q(M);{var $=S=>{Ve(S,{get sessionId(){return t(n)},onComplete:()=>c(e,"done")})},D=S=>{var G=V(),H=Q(G);{var q=W=>{Xe(W)};F(H,W=>{t(e)==="done"&&W(q)},!0)}h(S,G)};F(I,S=>{t(e)==="screentime"?S($):S(D,!1)},!0)}h(T,M)};F(i,T=>{t(e)==="result"?T(z):T(R,!1)},!0)}h(_,y)};F(m,_=>{t(e)==="test"?_(N):_(A,!1)},!0)}h(v,k)};F(d,v=>{t(e)==="instructions"?v(p):v(f,!1)})}s(u),h(g,u)}export{mt as component};

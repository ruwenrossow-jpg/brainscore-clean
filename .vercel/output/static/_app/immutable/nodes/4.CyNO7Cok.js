import{f as n,a as e,c as Y,t as H}from"../chunks/O6Scfog5.js";import{o as Le}from"../chunks/ClDAKjVE.js";import{n as Z,s,f as _,c as a,r as t,t as ne,p as Ce,a as Me,g as i,d as Be,$ as Ne,ar as Ze,b as Ee,as as qe,aD as be}from"../chunks/_KxZsWR2.js";import{s as V,d as Ke}from"../chunks/DYLJxuZE.js";import{i as u}from"../chunks/C5zH9Bdp.js";import{h as Ge}from"../chunks/DAPy_qUL.js";import{s as Fe,a as pe}from"../chunks/D6LAuGEZ.js";import{g as ye}from"../chunks/Cx1u6K8_.js";import{i as Re,n as We,a as je,b as Ye}from"../chunks/C5Chkb5p.js";import{s as Te}from"../chunks/BsE10o59.js";import{p as Ae}from"../chunks/DRmyG4Sl.js";import{B as Pe}from"../chunks/DUngGjmV.js";import{e as Je}from"../chunks/BHVu21DL.js";import{s as Qe}from"../chunks/i09DBs4C.js";import{B as Ue}from"../chunks/Da8G-eBB.js";async function Xe(m){const{data:r,error:l}=await Te.from("sart_sessions").select("brain_score").eq("user_id",m).order("created_at",{ascending:!1}).limit(1).single();return l?(l.code==="PGRST116"||console.error("Error fetching current score:",l),null):(r==null?void 0:r.brain_score)??null}async function He(m,r=10){const{data:l,error:p}=await Te.from("sart_sessions").select("id, brain_score, commission_errors, omission_errors, created_at").eq("user_id",m).order("created_at",{ascending:!1}).limit(r);return p?(console.error("Error fetching session history:",p),[]):(l||[]).map(c=>({id:c.id,score:c.brain_score,commissionErrors:c.commission_errors,omissionErrors:c.omission_errors,createdAt:new Date(c.created_at)}))}async function Ie(m){const r=new Date;r.setDate(r.getDate()-7);const{data:l,error:p}=await Te.from("sart_sessions").select("brain_score").eq("user_id",m).gte("created_at",r.toISOString());if(p)return console.error("Error fetching 7-day average:",p),null;if(!l||l.length===0)return null;const c=l.reduce((M,D)=>M+D.brain_score,0);return Math.round(c/l.length)}async function $e(m){const{count:r,error:l}=await Te.from("sart_sessions").select("*",{count:"exact",head:!0}).eq("user_id",m);return l?(console.error("Error fetching total tests:",l),0):r||0}async function et(m){const[r,l,p,c]=await Promise.all([Xe(m),Ie(m),$e(m),He(m,1)]);return{currentScore:r,averageScore7Days:l,totalTests:p,lastTestDate:c.length>0?c[0].createdAt:null}}var tt=n('<div class="flex justify-center"><span class="loading loading-spinner loading-lg"></span></div>'),at=n('<div class="badge badge-success badge-lg">Ausgezeichnet ðŸŽ¯</div> <p class="mt-2 text-gray-600">Deine Konzentration ist exzellent!</p>',1),rt=n('<div class="badge badge-info badge-lg">Sehr gut âœ¨</div> <p class="mt-2 text-gray-600">Du bist fokussiert und aufmerksam.</p>',1),st=n('<div class="badge badge-warning badge-lg">Gut ðŸ’ª</div> <p class="mt-2 text-gray-600">Solide Leistung, mit Luft nach oben.</p>',1),it=n('<div class="badge badge-error badge-lg">VerbesserungswÃ¼rdig ðŸŽ“</div> <p class="mt-2 text-gray-600">Mehr Ãœbung bringt bessere Ergebnisse!</p>',1),ot=n('<div class="text-7xl font-bold mb-2"> </div> <p class="text-gray-600">von 225 Punkten</p> <div class="mt-6 text-sm"><!></div>',1),nt=n('<div class="text-gray-400 py-8"><svg class="w-24 h-24 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg> <p class="text-xl font-semibold mb-2">Noch keine Tests absolviert</p> <p class="text-gray-600">Starte deinen ersten Konzentrationstest!</p></div>'),lt=n('<div class="text-center py-8"><h2 class="text-2xl font-bold mb-4">Dein aktueller BrainScore</h2> <!></div>'),vt=n(`/**
 * Current BrainScore Card Component
 * Displays the user's latest BrainScore in a prominent card
 */ <!>`,1);function dt(m,r){let l=Ae(r,"loading",3,!1);Z();var p=vt(),c=s(_(p));Pe(c,{children:(M,D)=>{var S=lt(),y=s(a(S),2);{var g=T=>{var k=tt();e(T,k)},w=T=>{var k=Y(),O=_(k);{var q=d=>{var b=ot(),v=_(b),B=a(v,!0);t(v);var K=s(v,4),E=a(K);{var C=z=>{var L=at();Z(2),e(z,L)},G=z=>{var L=Y(),h=_(L);{var x=A=>{var F=rt();Z(2),e(A,F)},U=A=>{var F=Y(),R=_(F);{var ae=P=>{var X=st();Z(2),e(P,X)},te=P=>{var X=it();Z(2),e(P,X)};u(R,P=>{r.score>=120?P(ae):P(te,!1)},!0)}e(A,F)};u(h,A=>{r.score>=150?A(x):A(U,!1)},!0)}e(z,L)};u(E,z=>{r.score>=180?z(C):z(G,!1)})}t(K),ne(()=>V(B,r.score)),e(d,b)},J=d=>{var b=nt();e(d,b)};u(O,d=>{r.score!==null?d(q):d(J,!1)},!0)}e(T,k)};u(y,T=>{l()?T(g):T(w,!1)})}t(S),e(M,S)},$$slots:{default:!0}}),e(m,p)}var ct=n('<div class="flex justify-center py-8"><span class="loading loading-spinner loading-md"></span></div>'),gt=n('<div class="mt-4 p-4 bg-blue-50 rounded-lg"><p class="text-sm text-blue-800">ðŸ’¡ <strong>Tipp:</strong> Absolviere regelmÃ¤ÃŸig Tests, um deinen Fortschritt zu verfolgen!</p></div>'),ft=n('<div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div class="stat bg-base-200 rounded-lg"><div class="stat-title">7-Tage Ã˜</div> <div class="stat-value text-3xl"> </div> <div class="stat-desc">Durchschnittlicher Score</div></div> <div class="stat bg-base-200 rounded-lg"><div class="stat-title">Gesamt Tests</div> <div class="stat-value text-3xl"> </div> <div class="stat-desc">Absolvierte Tests</div></div> <div class="stat bg-base-200 rounded-lg"><div class="stat-title">Letzter Test</div> <div class="stat-value text-2xl"> </div> <div class="stat-desc">Zuletzt aktiv</div></div></div> <!>',1),ut=n('<h3 class="text-xl font-bold mb-4">Statistiken</h3> <!>',1),mt=n(`/**
 * Stats Card Component
 * Displays aggregated statistics (7-day average, total tests, etc.)
 */ <!>`,1);function _t(m,r){Ce(r,!0);let l=Ae(r,"loading",3,!1);function p(D){if(!D)return"Nie";const y=new Date().getTime()-D.getTime(),g=Math.floor(y/6e4),w=Math.floor(y/36e5),T=Math.floor(y/864e5);return g<60?`Vor ${g} Min.`:w<24?`Vor ${w} Std.`:T<7?`Vor ${T} Tag${T===1?"":"en"}`:D.toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})}Z();var c=mt(),M=s(_(c));Pe(M,{children:(D,S)=>{var y=ut(),g=s(_(y),2);{var w=k=>{var O=ct();e(k,O)},T=k=>{var O=ft(),q=_(O),J=a(q),d=s(a(J),2),b=a(d,!0);t(d),Z(2),t(J);var v=s(J,2),B=s(a(v),2),K=a(B,!0);t(B),Z(2),t(v);var E=s(v,2),C=s(a(E),2),G=a(C,!0);t(C),Z(2),t(E),t(q);var z=s(q,2);{var L=h=>{var x=gt();e(h,x)};u(z,h=>{r.totalTests===0&&h(L)})}ne(h=>{V(b,r.averageScore7Days??"â€”"),V(K,r.totalTests),V(G,h)},[()=>p(r.lastTestDate)]),e(k,O)};u(g,k=>{l()?k(w):k(T,!1)})}e(D,y)},$$slots:{default:!0}}),e(m,c),Me()}var ht=n('<span class="text-sm text-gray-600"> </span>'),xt=n('<div class="flex justify-center py-8"><span class="loading loading-spinner loading-md"></span></div>'),bt=n('<div class="text-center py-12 text-gray-400"><svg class="w-16 h-16 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p class="text-lg font-semibold mb-2">Noch keine Tests vorhanden</p> <p class="text-sm">Deine Test-Historie erscheint hier nach dem ersten Test.</p></div>'),pt=n('<div class="flex items-center justify-between p-4 bg-base-200 rounded-lg hover:bg-base-300 transition-colors"><div class="flex-1"><div class="flex items-center gap-3 mb-2"><div> </div> <span class="text-sm text-gray-600"> </span></div> <div class="text-sm text-gray-600 flex gap-4"><span><strong>CE:</strong> </span> <span><strong>OE:</strong> </span></div></div> <div class="w-12 h-12 rounded-full bg-white flex items-center justify-center text-2xl"><!></div></div>'),yt=n('<div class="mt-4 text-center"><p class="text-sm text-gray-600">Zeige die letzten 10 Tests</p></div>'),Tt=n('<div class="space-y-3"></div> <!>',1),Dt=n('<div class="flex justify-between items-center mb-4"><h3 class="text-xl font-bold">Test-Verlauf</h3> <!></div> <!>',1),St=n(`/**
 * Session History Component
 * Displays a timeline/list of recent SART test sessions
 */ <!>`,1);function wt(m,r){Ce(r,!0);let l=Ae(r,"loading",3,!1);function p(S){return S.toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}function c(S){return S>=180?"badge-success":S>=150?"badge-info":S>=120?"badge-warning":"badge-error"}Z();var M=St(),D=s(_(M));Pe(D,{children:(S,y)=>{var g=Dt(),w=_(g),T=s(a(w),2);{var k=d=>{var b=ht(),v=a(b);t(b),ne(()=>V(v,`${r.sessions.length??""} EintrÃ¤ge`)),e(d,b)};u(T,d=>{r.sessions.length>0&&d(k)})}t(w);var O=s(w,2);{var q=d=>{var b=xt();e(d,b)},J=d=>{var b=Y(),v=_(b);{var B=E=>{var C=bt();e(E,C)},K=E=>{var C=Tt(),G=_(C);Je(G,21,()=>r.sessions,h=>h.id,(h,x)=>{var U=pt(),A=a(U),F=a(A),R=a(F),ae=a(R);t(R);var te=s(R,2),P=a(te,!0);t(te),t(F);var X=s(F,2),re=a(X),ge=s(a(re));t(re);var le=s(re,2),ve=s(a(le));t(le),t(X),t(A);var de=s(A,2),fe=a(de);{var De=W=>{var Q=H("ðŸŽ¯");e(W,Q)},Se=W=>{var Q=Y(),ue=_(Q);{var me=I=>{var se=H("âœ¨");e(I,se)},we=I=>{var se=Y(),_e=_(se);{var he=$=>{var o=H("ðŸ’ª");e($,o)},xe=$=>{var o=H("ðŸ“š");e($,o)};u(_e,$=>{i(x).score>=120?$(he):$(xe,!1)},!0)}e(I,se)};u(ue,I=>{i(x).score>=150?I(me):I(we,!1)},!0)}e(W,Q)};u(fe,W=>{i(x).score>=180?W(De):W(Se,!1)})}t(de),t(U),ne((W,Q)=>{Qe(R,1,W),V(ae,`${i(x).score??""} Punkte`),V(P,Q),V(ge,` ${i(x).commissionErrors??""}`),V(ve,` ${i(x).omissionErrors??""}`)},[()=>`badge ${c(i(x).score)}`,()=>p(i(x).createdAt)]),e(h,U)}),t(G);var z=s(G,2);{var L=h=>{var x=yt();e(h,x)};u(z,h=>{r.sessions.length>=10&&h(L)})}e(E,C)};u(v,E=>{r.sessions.length===0?E(B):E(K,!1)},!0)}e(d,b)};u(O,d=>{l()?d(q):d(J,!1)})}e(S,g)},$$slots:{default:!0}}),e(m,M),Me()}var kt=n('<div class="flex items-center justify-center min-h-screen"><div class="loading loading-spinner loading-lg"></div></div>'),zt=n('<header class="border-b border-gray-200"><div class="container mx-auto px-4 py-6"><div class="flex justify-between items-center"><div><h1 class="text-3xl font-bold">BrainScore Dashboard</h1> <p class="text-gray-600 mt-1"> </p></div> <button class="btn btn-ghost">Abmelden</button></div></div></header> <main class="container mx-auto px-4 py-8"><div class="max-w-6xl mx-auto space-y-8"><!> <div class="text-center"><!></div> <!> <!> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="card bg-base-200 shadow-lg"><div class="card-body"><h3 class="card-title text-lg">ðŸ“Š Deine Ziele</h3> <p class="text-sm text-gray-600"><!></p></div></div> <div class="card bg-base-200 shadow-lg"><div class="card-body"><h3 class="card-title text-lg">ðŸ’¡ Tipp des Tages</h3> <p class="text-sm text-gray-600"><!></p></div></div></div></div></main> <footer class="border-t border-gray-200 mt-16"><div class="container mx-auto px-4 py-6 text-center text-gray-600 text-sm"><p> </p></div></footer>',1),Bt=n(`/**
 * Dashboard Page
 * Main dashboard for logged-in users showing BrainScore and test history
 */  <div class="min-h-screen bg-white"><!></div>`,1);function Ft(m,r){Ce(r,!0);const l=()=>pe(Re,"$isAuthenticated",D),p=()=>pe(We,"$needsOnboarding",D),c=()=>pe(je,"$auth",D),M=()=>pe(Ye,"$currentProfile",D),[D,S]=Fe();let y=Be(!0),g=Be(null),w=Be(Ne([]));Le(async()=>{if(!l()){ye("/auth");return}if(p()){ye("/onboarding");return}if(c().user)try{const v=c().user.id,[B,K]=await Promise.all([et(v),He(v,10)]);Ee(g,B,!0),Ee(w,K,!0)}catch(v){console.error("Error loading dashboard:",v)}finally{Ee(y,!1)}});function T(){ye("/test")}async function k(){await je.signOut(),ye("/")}Z();var O=Bt();Ge("x1i5gj",v=>{Ze(()=>{qe.title="Dashboard | BrainScore"})});var q=s(_(O)),J=a(q);{var d=v=>{var B=kt();e(v,B)},b=v=>{var B=Y(),K=_(B);{var E=C=>{var G=zt(),z=_(G),L=a(z),h=a(L),x=a(h),U=s(a(x),2),A=a(U);t(U),t(x);var F=s(x,2);F.__click=k,t(h),t(L),t(z);var R=s(z,2),ae=a(R),te=a(ae);{let o=be(()=>{var f;return((f=i(g))==null?void 0:f.currentScore)??null});dt(te,{get score(){return i(o)},get loading(){return i(y)}})}var P=s(te,2),X=a(P);Ue(X,{onclick:T,variant:"primary",size:"lg",get disabled(){return i(y)},children:(o,f)=>{var ie=Y(),j=_(ie);{var ke=N=>{var ce=H("ðŸŽ¯ Ersten Test starten");e(N,ce)},ee=N=>{var ce=H("ðŸ”„ Neuen Test starten");e(N,ce)};u(j,N=>{i(g)&&i(g).totalTests===0?N(ke):N(ee,!1)})}e(o,ie)},$$slots:{default:!0}}),t(P);var re=s(P,2);{let o=be(()=>{var j;return((j=i(g))==null?void 0:j.averageScore7Days)??null}),f=be(()=>{var j;return((j=i(g))==null?void 0:j.totalTests)??0}),ie=be(()=>{var j;return((j=i(g))==null?void 0:j.lastTestDate)??null});_t(re,{get averageScore7Days(){return i(o)},get totalTests(){return i(f)},get lastTestDate(){return i(ie)},get loading(){return i(y)}})}var ge=s(re,2);wt(ge,{get sessions(){return i(w)},get loading(){return i(y)}});var le=s(ge,2),ve=a(le),de=a(ve),fe=s(a(de),2),De=a(fe);{var Se=o=>{var f=H();ne(()=>V(f,M().goal)),e(o,f)},W=o=>{var f=H("Noch kein Ziel gesetzt");e(o,f)};u(De,o=>{var f;(f=M())!=null&&f.goal?o(Se):o(W,!1)})}t(fe),t(de),t(ve);var Q=s(ve,2),ue=a(Q),me=s(a(ue),2),we=a(me);{var I=o=>{var f=H("Starte mit deinem ersten Test, um eine Baseline zu erstellen!");e(o,f)},se=o=>{var f=Y(),ie=_(f);{var j=ee=>{var N=H("Absolviere mindestens 5 Tests fÃ¼r aussagekrÃ¤ftige Trends.");e(ee,N)},ke=ee=>{var N=Y(),ce=_(N);{var Ve=oe=>{var ze=H("Versuche, dich vor dem Test 5 Minuten zu entspannen.");e(oe,ze)},Oe=oe=>{var ze=H("Konsistenz ist der SchlÃ¼ssel â€“ teste regelmÃ¤ÃŸig zur gleichen Zeit!");e(oe,ze)};u(ce,oe=>{i(w).length>0&&i(w)[0].score<150?oe(Ve):oe(Oe,!1)},!0)}e(ee,N)};u(ie,ee=>{i(g)&&i(g).totalTests<5?ee(j):ee(ke,!1)},!0)}e(o,f)};u(we,o=>{i(g)&&i(g).totalTests===0?o(I):o(se,!1)})}t(me),t(ue),t(Q),t(le),t(ae),t(R);var _e=s(R,2),he=a(_e),xe=a(he),$=a(xe);t(xe),t(he),t(_e),ne(o=>{var f;V(A,`Willkommen zurÃ¼ck, ${(((f=M())==null?void 0:f.name)||"dort")??""}!`),V($,`BrainScore Â© ${o??""} â€¢ Deine persÃ¶nliche Konzentrationsanalyse`)},[()=>new Date().getFullYear()]),e(C,G)};u(K,C=>{l()&&C(E)},!0)}e(v,B)};u(J,v=>{c().loading||i(y)?v(d):v(b,!1)})}t(q),e(m,O),Me(),S()}Ke(["click"]);export{Ft as component};
